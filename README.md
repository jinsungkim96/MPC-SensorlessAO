# MPC-SensorlessAO
This is a `Matlab` implementation of the Model Predictive Control of Time-varying Aberrations for Sensorless Adaptive Optics from Jinsung~Kim et al. [[1]], designed for Sensorless adaptive optics. It maintains estimates of the moments of the gradient independently for each parameter.

##  Generating Time-varying Phase aberration
The time-varying phase aberration caused by atmospheric turbulence is generated by Object-Oriented MATLAB & Adaptive Optics (OOMAO) Toolbox [[2]].

```matlab
samplingFreq = 200; % turbulence sampling frequency
nSimSteps = 2000;
T_final = nSimSteps;
nPolynomials = 28; % number of zernike modes (radial number = 6)

D = 1; % telescope diameter [m]
r0 = 0.2; % Fried parameter [m]
L0 = 42; % outer scale [m]

% mainly frozen-flow model
h = [1000, 5000, 12000]; % height [m]
v0 = [5, 7.5, 10]; % wind speed [m/s]
vD = [0, pi/3, 5*pi/3];

f_r0 = [0.7, 0.1, 0.2]./25; % Fractional r0

addpath(genpath('D:\Users\Her\Documents\MATLAB\AO\4F-Optical-Correlator-Simulation-kim\OOMAO-master'))
atm = atmosphere(photometry.V,r0,L0,'fractionnalR0',f_r0,'altitude',h,'windSpeed',v0,'windDirection',vD); % atmosphere

% telescope setting
nL = 512; % number of lenslet
nPx = 1; % number or pixel per lenslet
nRes = nL*nPx; % resolution
xaxis = 1:nRes;
d = D/nL; % lenslet pitch

tel = telescope(D,'resolution',nRes,'fieldOfViewInArcsec',2.5,'samplingTime',1/samplingFreq); % telescope
tel = tel + atm;

% Photometric system
% Band ( wavelength , bandwidth , zero point )
% V  ( 0.550e-6 , 0.090e-6 , 3.3e12 )
ngs = source('wavelength',photometry.V); % natural guide star
ngs = ngs.*tel;
```


<img src="images/SensorlessAO_overview.eps" />
<img src="images/block_diagram.png" />

[![Hits](https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2Frlawlstjd960%2Fhit-counter&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false)](https://hits.seeyoufarm.com)

## References
[[1]] Jinsung Kim, Kye-Sung Lee, Sang-Chul Lee, Ji Yong Bae, Dong Uk Kim, I Jong Kim, Ki Soo Chang and Hwan Hur. "Model Model Predictive Control of Time-varying Aberrations for Sensorless Adaptive Optics", arXiv preprint. [https://arxiv.org/abs/--](https://arxiv.org/abs/--)

[[2]] R. Conan and C. Correia, “Object-oriented Matlab adaptive optics toolbox,” in Adaptive Optics Systems IV (E. Marchetti, L. M. Close, and J.-P. Vran, eds.), vol. 9148 of Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series, p. 91486C, Aug. 2014.

[1]: https://arxiv.org/abs/--
[2]: https://www.spiedigitallibrary.org/conference-proceedings-of-spie/9148/91486C/Object-oriented-Matlab-adaptive-optics-toolbox/10.1117/12.2054470.short
